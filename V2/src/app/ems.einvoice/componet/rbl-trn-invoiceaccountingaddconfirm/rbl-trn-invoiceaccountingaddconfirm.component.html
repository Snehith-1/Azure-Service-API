<div class="card rounded-top">
    <div class="card-title p-5 pb-6 pt-6 rounded-top bg-primary">
      <h3 class="fw-bolder text-white">
        + Invoice Add Confirm
      </h3>
    </div>
  
    <form [formGroup]="invoiceaccountingform" (ngSubmit)="salesinvoicesubmit()">
      <div class="card m-3 border">
        <div class="card-header bg-lightblue card-height55">
          <div class="card-title m-0">
            <h4 class="fw-bolder text-blue">Invoice Details</h4>
          </div>
        </div>
      </div>
  
    <div class="d-flex flex-row m-6 flex-wrap">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold required">Invoice Reference No</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                <input type="text"
                    class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input"
                    formControlName="invoiceaccounting_refno" placeholder="New Reference No."
                    [ngStyle]="{'border-color': invoiceaccountingformrefnoControl.invalid && invoiceaccountingformrefnoControl.touched ? 'red' : 'rgb(209, 209, 209)'}"
                    pattern="^(?!\s*$).+" readonly>
                <div *ngIf="invoiceaccountingformrefnoControl.invalid && invoiceaccountingformrefnoControl.touched">
                    <div *ngIf="invoiceaccountingformrefnoControl.hasError('required')" class="text-red">Invoice
                        ref.no is required</div>
                </div>
            </div>
        </div>
    
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold required">Invoice Date</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                <input type="date"
                class="form-control form-control-lg form-control-solid date-picker mb-3 mb-lg-0 bg-white border-secondary custom-input"
                formControlName="invoice_date"
                [ngStyle]="{'border-color': invoiceaccountingdateControl.invalid && invoiceaccountingdateControl.touched ? 'red' : 'rgb(209, 209, 209)'}"
                pattern="^(?!\s*$).+">
            <div *ngIf="invoiceaccountingdateControl.invalid && invoiceaccountingdateControl.touched">
                <div *ngIf="invoiceaccountingdateControl.hasError('required')" class="text-red">Invoice date is
                    required</div>
            </div>
            </div>            
        </div>
    
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Payment Term (In Days)</span>
          <ng-select class="col-12 col-lg-11 col-md-11 col-sm-11 fv-row mt-2" formControlName="invoiceaccounting_payterm" [(ngModel)]="mdlaccpayterm" placeholder="Select an option">
            <ng-option value="0">0 Days</ng-option>
            <ng-option value="7">7 Days</ng-option>
            <ng-option value="15">15 Days</ng-option>
            <ng-option value="30">30 Days</ng-option>
            <ng-option value="45">45 Days</ng-option>
            <ng-option value="60">60 Days</ng-option>
            <ng-option value="90">90 Days</ng-option>
            <ng-option value="120">120 Days</ng-option>
          </ng-select>
        </div>
    </div>
  
      <div class="d-flex flex-row m-6 flex-wrap">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Due Date</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="date" class="form-control form-control-lg form-control-solid date-picker mb-3 mb-lg-0 bg-white border-secondary custom-input" formControlName="invoiceaccounting_duedate">
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Order Ref No</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary border-secondary custom-input" formControlName="invoiceaccounting_orderrefno" readonly>
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Order Date</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="date" class="form-control form-control-lg form-control-solid date-picker mb-3 mb-lg-0 bg-white border-secondary custom-input" formControlName="invoiceaccounting_orderdate">
          </div>
        </div>
      </div>
  
      <div class="card m-3 border">
        <div class="card-header bg-lightblue card-height55">
          <div class="card-title m-0">
            <h4 class="fw-bolder text-blue">Customer Details</h4>
          </div>
        </div>
      </div>
  
      <div class="d-flex flex-row m-6 flex-wrap">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Customer Name</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input fw-bold" formControlName="invoiceaccounting_customername" readonly>
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">E-Mail</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input fw-bold" formControlName="invoiceaccounting_email" readonly>
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Contact Person Name</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input fw-bold" formControlName="invoiceaccounting_contactperson" readonly>
          </div>
        </div>
      </div>
  
      <div class="d-flex flex-row m-6 flex-wrap">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Contact Number</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input fw-bold" formControlName="invoiceaccounting_contactnumber" readonly>
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Customer Address</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <textarea type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary border-secondary custom-input fw-bold" formControlName="invoiceaccounting_customeraddress" rows="3" class="form-control bg-secondary" readonly></textarea>
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Branch</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary custom-input fw-bold" formControlName="invoiceaccounting_branch" readonly>
          </div>
        </div>
      </div>

      <div class="d-flex flex-row m-6 flex-wrap">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Currency</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary border-secondary custom-input" formControlName="invoiceaccounting_currency" readonly>
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold">Exchange Rate</span>
          <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
            <input type="text" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-secondary border-secondary custom-input fw-bold" formControlName="invoiceaccounting_exchangerate" readonly style="text-align: right;">
          </div>
        </div>
  
        <div class="col-12 col-lg-4 col-md-6 col-sm-12"><span class="font-bold required">Sales Type</span>
          <ng-select class="col-12 col-lg-11 col-md-11 col-sm-11 fv-row mt-2" formControlName="invoiceaccounting_salestype" [(ngModel)]="mdlaccsalestype" placeholder="Select an option" [class.is-invalid]="invoiceaccountingform.get('invoiceaccounting_salestype')?.invalid && (invoiceaccountingform.get('invoiceaccounting_salestype')?.dirty || invoiceaccountingform.get('invoiceaccounting_salestype')?.touched)" [ngClass]="{'invalid-border': invoiceaccountingform.get('invoiceaccounting_salestype')?.invalid && invoiceaccountingform.get('invoiceaccounting_salestype')?.touched}">
            <ng-option value="Services and Enterprise Product">Services and Enterprise Product</ng-option>
            <ng-option value="Service type">Service type</ng-option>
            <ng-option value="B2B">B2B</ng-option>
          </ng-select>            
          <div *ngIf="invoiceaccountingform.get('invoiceaccounting_salestype')?.hasError('required') && invoiceaccountingform.get('invoiceaccounting_salestype')?.touched || invoiceaccountingform.get('invoiceaccounting_salestype')?.hasError('pattern')" class="text-red">Sales type is required</div>
        </div>
      </div>

      <div class="d-flex flex-row m-6 flex-wrap">
        <div class="col-12 col-lg-4 col-md-6 col-sm-12 mt-2"><span class="font-bold">Remarks</span>
            <div class="col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2">
                <textarea type="text" rows="1" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 bg-white border-secondary custom-input" formControlName="invoiceaccounting_remarks" rows="3"></textarea>
            </div>
          </div>
      </div>

      <div class="card-header bg-lightblue card-height55">
        <div class="card-title m-0">
          <h4 class="fw-bolder text-blue">Product Summary</h4>
        </div>
      </div>
  
      <div class="table-responsive">
        <div class="mx-3 p-3 pt-0 pb-0 bg-white rounded mt-2">
          <table id="product" class="table table-striped table-row-bordered border-bottom gs-7 align-middle">
            <thead>
              <tr class="fw-bolder fs-5 text-nowrap bg-lightblue text-blue align-middle">
                <th style="text-align: center;">S.No</th>
                <th>Product Name</th>
                <th style="text-align: center;">Quantity</th>
                <th style="text-align: right;">Discount (%)</th>
                <th style="text-align: right;">Unit Price</th>                
                <th style="text-align: right; width: 120px;">Tax</th>
                <th style="text-align: right;">Total Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of invoiceaccountinglist; let i=index;" class="align-middle">
                <td style="text-align: center;">{{i+1}}</td>
                <td>{{data.product_name}}</td>
                <td style="text-align: center;">{{data.qty_invoice}}</td>
                <td style="text-align: right;">{{data.discount}}</td>
                <td style="text-align: right;">{{data.product_price}}</td>                
                <td style="text-align: right;">{{data.tax}}</td>
                <td style="text-align: right; font-weight: bold;">{{data.product_total}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
  
      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Net Amount :</label>
          <input type="text" class="form-control fw-bold bg-secondary" formControlName="invoiceaccounting_grandtotal" style="width:120px; text-align: right;"
            readonly>
        </div>
      </div>

      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Tax :</label>
          <input type="text" class="form-control fw-bold bg-secondary" formControlName="invoiceaccounting_overall_tax" style="width:120px; text-align: right;"
            readonly>
        </div>
      </div>

      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Order Discount Amount :</label>
          <input type="text" class="form-control fw-bold bg-secondary" formControlName="invoiceaccouting_orderdiscountamount" style="width:120px; text-align: right;"
            readonly>
        </div>
      </div>

      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Order Add On Amount :</label>
          <input type="text" class="form-control fw-bold bg-secondary" formControlName="invoiceaccounting_addon_amount" style="width:120px; text-align: right;"
            readonly>
        </div>
      </div>

      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Order Total :</label>
          <input type="text" class="form-control fw-bold bg-secondary" formControlName="invoiceaccounting_ordertotal" style="width:120px; text-align: right;">
        </div>
      </div>

      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Discount Amount :</label>
          <input type="text" class="form-control fw-bold bg-secondary" formControlName="invoiceaccounting_discountamount" style="width:120px; text-align: right;">
        </div>
      </div>
  
      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Add On Amount </label>
          <input type="text" class="form-control" formControlName="invoiceaccounting_addonamount" style="width:120px; text-align: right;">
        </div>
      </div>
  
      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Freight Charges :</label>
          <input type="text" class="form-control" formControlName="invoiceaccounting_freightcharges" style="width:120px; text-align: right;">
        </div>
      </div>

      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Buyback Charges :</label>
          <input type="text" class="form-control" formControlName="invoiceaccounting_buybackcharges" style="width:120px; text-align: right;">
        </div>
      </div>
  
      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Packing Charges :</label>
          <input type="text" class="form-control" formControlName="invoiceaccounting_packingcharges" style="width:120px; text-align: right;" readonly>
        </div>
      </div>
  
      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Insurance Charges :</label>
          <input type="text" class="form-control" formControlName="invoiceaccounting_insurancecharges" style="width:120px; text-align: right;">
        </div>
      </div>

      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Outstanding Invoice Amount :</label>
          <input type="text" class="form-control" formControlName="invoiceaccounting_outstandingamount" style="width:120px; text-align: right;">
        </div>
      </div>
  
      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Round Off :</label>
          <input type="text" class="form-control" formControlName="invoiceaccounting_roundoff" style="width:120px; text-align: right;">
        </div>
      </div>
  
      <div class="d-flex row justify-content-end mt-2">
        <div class="col-md-3 d-flex align-items-center">
          <label class="col-sm-6 col-form-label font-bold">Grand Total :</label>
          <input type="text" class="form-control fw-bold bg-secondary" formControlName="invoiceaccounting_grandtotal" style="width:120px; text-align: right;" readonly>
        </div>
      </div>
  
      <div>
        <div class="card-header bg-lightblue card-height55 mt-5">
          <div class="card-title m-0">
            <h4 class="fw-bolder text-blue">Terms and Conditions</h4>
          </div>
        </div>
  
        <ng-select [items]="terms_list" class="custom col-lg-5 m-12 col-12 fv-row mt-2" bindLabel="template_name"
          [(ngModel)]="mdlTerms" formControlName="template_name" bindValue="template_gid" placeholder="Select an option"
          (change)="GetOnChangeTerms()"></ng-select>
  
        <div class="d-flex flex-row m-6 flex-wrap">
          <div class="col-12 col-lg-12 col-md-12 col-sm-12 fv-row mt-2">
            <angular-editor [config]="config" formControlName="termsandconditions"></angular-editor>
          </div>
        </div>
      </div>
  
      <div class="text-center my-4">
        <button type="submit" class="btn-success btn-sm text-white me-2"
          [disabled]="invoiceaccountingform.invalid">
          <i class="bi bi-check-square fs-5"></i>
          <span class="ms-3">Submit</span>
        </button>
  
        <button type="back" class="btn-primary btn-sm text-white me-4" (click)="back()">
          <i class="bi bi-arrow-left-square fs-5 me-1"></i>
          <span class="ms-3">Back</span>
        </button>
      </div>
    </form>
  </div>
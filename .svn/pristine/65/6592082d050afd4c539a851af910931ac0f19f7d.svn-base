<div class="col-lg-12 col-md-12 col-sm-12">
  <div class="card me-lg-3 me-0">
    <div class="card-header bg-lightblue card-height55">
      <div class="card-title m-0">
        <h5 class="fw-bolder text-blue">Assign Employee</h5>
      </div>
    </div>

    <br>
    <div class="card-body col-12 col-lg-12 col-md-12 col-sm-12 fv-row mt-2" style="padding: 0rem 1rem;">
      <div class="row">
        <div class="col-lg-8 col-md-8 col-sm-8">
          <span class="font-bold">Employee <span style="color:red;">*</span></span>
          <ng-select [items]="employeelist" class=" mt-2" [multiple]="true" [selectableGroup]="true"
            [closeOnSelect]="false" bindLabel="employee_name" bindValue="employee_gid" placeholder="Select an option"
            [(ngModel)]="cboselectedEmployee">
            <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
              <input id="item-{{index}}" type="checkbox" [ngModel]="item$.selected" />&nbsp;&nbsp;
              {{item.employee_name}}
            </ng-template>
          </ng-select>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3"><span class="font-bold">Assign Hierarchy</span>
          <ng-select [items]="ModuleHierarchy" [(ngModel)]="cboassignhierarchy" bindValue="employee_gid"
            class="custom col-lg-11 col-12 col-md-11 col-sm-11 fv-row mt-2" bindLabel="user_name"
            placeholder="Select an option"></ng-select>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2">
          <br />
          <button title="Assign" type="button" [disabled]="!cboselectedEmployee" (click)="addmoduleuser()"
            class="btn btn-icon btn-sm bg-primary  mt-2"><span
              class="fa-solid fa-plus text-white  fs-6"></span></button>
        </div>
      </div>


      <br />
      <div class="row">
        <div class="col-lg-12 col-sm-12 col-md-12">
          <div class="row">
            <div class="col-lg-12 col-sm-12 col-md-12">
              <label for="exampleFormControlInput1" class="fw-bold mb-1" style="font-size:1.15rem;">Assigned Employee
              </label>
              <p class="float-end"><button class="no-privileges-button"></button>&nbsp;Color Indicates User has no
                privileges </p>

            </div>
          </div>
          <table id="assignemployeetable" class="table table-striped table-row-bordered gy-5 gs-5 mt-4">
            <thead>
              <tr class="fw-bold fs-5 text-nowrap bg-lightblue text-blue">
                <th>S.No</th>
                <th>User Code</th>
                <th>User Name</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of ModuleAssignedemployeeinfo; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.user_code}}</td>
                <td>{{data.user_name}}</td>
                <td [ngClass]="{'no-menu-access': data.menuaccess === '0'}"><a
                    style="text-decoration: underline;cursor: pointer;" data-bs-toggle="modal"
                    data-bs-target="#userrolemodal"
                    (click)="UserRoleClick(data.user_gid,data.user_code,data.user_name)">User Role</a></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="text-center my-4">

        <button class="btn-primary btn-sm text-white me-4" (click)="backbutton()">
          <i class="fas fa-arrow-left"></i> &nbsp;
          Back</button>

      </div>
    </div>
  </div>
</div>

<div class="modal top fade" id="userrolemodal" tabindex="-1" aria-labelledby="kt_modal_1" aria-hidden="true"
  data-bs-backdrop='static' data-mdb-keyboard="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class=" bg-primary rounded-top">
        <h3 class="p-4 pt-5 text-white "> <i class="fas fa-plus fs-5"></i>&nbsp;&nbsp;&nbsp; User Role </h3>
      </div>

      <div id="scroll-container" class="m-4 overflow-auto mt-0" style="height: 400px;">
        <div class="text-end align-middle mt-3" style="margin-right: 55px;">
            <input type="checkbox" id="checkAll"  (change)="$event ? masterToggle() : null"
                [checked]="selection.hasValue() && isAllSelected()" [checked]="true" class="align-middle"
               [indeterminate]="selection.hasValue() && !isAllSelected()" />&nbsp; <span class="align-middle">Check all</span>
        </div> 
       <br>

        <ng-container *ngFor="let data of userRoleMenulist">
          <div class="row">
            <div class="col-12">
              <div class="column" *ngFor="let j of data.submenu;">
                <div class="col" >
                  <h4 class="text-blue bg-lightblue p-3 rounded mt-2 text-center">{{ j.text }}</h4>

                  <ul class="list-group ps-0">

                    <li *ngFor="let k of j.sub1menu" class="list-group-item list-group-item-action striped-list">

                      <div class="row">
                        <div class="col-10">{{ k.text }}</div>
                        <div class="col-2"> <input type="checkbox" class="pull-right"
                            (change)="$event ? selection.toggle(k) : null" [checked]="selection.isSelected(k)"
                            [checked]="k.module_checked"></div>
                      </div>
                    </li>
                  </ul>
                </div>

              </div>
            </div>
      

          </div>


        </ng-container>

      </div>
      <div class="text-center mb-3">
        <button type="submit" class="btn-success text-white" data-bs-dismiss="modal" (click)="UserRoleselected()">
          <i class="fas fa-check text-white fs-5"></i>&nbsp;
          Confirm
        </button> &nbsp;
        <button type="button" class="btn-danger " data-bs-dismiss="modal">
          <i class="fa fa-close fs-5 text-center"></i>&nbsp;
          Close
        </button>
      </div>

    </div>
  </div>
</div>